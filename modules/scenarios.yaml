version: 3

includes:
  hedgedoc:
    taskfile: apps/hedgedoc/Taskfile.yaml
    dir: apps/hedgedoc

tasks:
  dex:
    cmds:
    - task: :k3d:create
      vars:
        CONFIG: dex
    - task: :traefik:deploy
    - task: :dex:deploy
    - task: :dex:deploy:dex-k8s-authenticator
  
  openunison:
    cmds:
    - task: :k3d:create
    - task: :ingress-nginx:deploy
    - task: :kubernetes-dashboard:deploy
    - task: :openunison:delete:kubernetes-dashboard-certs
    - task: :openunison:install
    - task: :openunison:restart:kubernetes-dashboard

  pinniped:
    cmds:
    - task: :k3d:create
    - task: :ingress-nginx:deploy
    - task: :pinniped:deploy

  rancher:
    cmds:
    - task: :k3d:create
    - task: :traefik:deploy
    - task: :rancher:deploy
    - task: :rancher:show:bootstrap-url

  openspeedtest:
    cmds:
    - task: :k3d:create
    - task: :traefik:deploy
    - task: :openspeedtest:deploy

  threatmapper:
    cmds:
    - task: :k3d:create
    - task: :traefik:deploy
    - task: :threatmapper:deploy:console
    
  hedgedoc:
    cmds:
    - task: :k3d:create
    - task: :traefik:deploy
    - task: hedgedoc:deploy
